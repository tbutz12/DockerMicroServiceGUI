version: "3.9"  # optional since v1.27.0
services:
  gui:
    build:
      context: ./java
      dockerfile: ./Dockerfile
    container_name: gui
    environment:
      - DISPLAY=192.168.1.162:0.0
  rstudio:
    image: "rocker/rstudio"
    ports:
      - 8787:8787
    environment:
      - DISABLE_AUTH=true
    container_name: rstudio
  jupyter:
    image: jupyter/minimal-notebook
    ports:
      - 8888:8888
    environment:
      - JUPYTER_TOKEN=easy
    container_name: jupyter
  markdown:
    image: "v4tech/markdown-editor"
    ports:
      - 12345:80
    container_name: "markdown"
  vs:
    image: ghcr.io/linuxserver/code-server
    container_name: code-server
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    volumes:
      - /path/to/appdata/config:/config
    ports:
      - 8443:8443
    restart: unless-stopped
    container_name: vs
  sonarqube:
    image: sonarqube
    ports:
      - 9001:9000
      - 9092:9092
    environment:
      - SONAR_ES_BOOTSTRAP_CHECKS_DISABLE=true
    container_name: sonarqube
    logging:
      driver: none
  spyder:
    build:
      context: ./spyder
    container_name: spyder
    environment:
      - DISPLAY=192.168.1.162:0.0
    ports:
      - 6004:6004
  orange:
    image: "tmb132/orange"
    container_name: orange
    environment:
      - DISPLAY=192.168.1.162:0.0
    ports:
      - 6008:6008
  git:
    image: "tmb132/git"
    container_name: git
    environment:
      - DISPLAY=192.168.1.162:0.0
    ports:
      - 6006:6006
  sas:
    build:
      context: ./sas
    container_name: sas
    ports:
      - 3002:3002
    environment:
      - DISPLAY=192.168.1.162:0.0
  namenode:
    build:
      context: ./hadooprun
    #image: bde2020/hadoop-namenode:2.0.0-hadoop3.2.1-java8
    container_name: namenode
    restart: always
    ports:
      - 9870:9870
      - 9000:9000
    volumes:
      - hadoop_namenode:/hadoop/dfs/name
      - /input:/input
      #- 'C:\Users\Tristin\Documents\GitHub\Docker_GUI_Microservice\namenode\myfileslocal:/jars'
    environment:
      - CLUSTER_NAME=test
    env_file:
      - ./hadoop.env
  namenode_run:
    build:
      context: ./name_noderun
    container_name: namenode_run
    environment:
      - DISPLAY=192.168.1.162:0.0
    ports:
      - 3004:3004
    privileged: true
    volumes:
        - /var/run/docker.sock:/var/run/docker.sock
  datanode:
    image: bde2020/hadoop-datanode:2.0.0-hadoop3.2.1-java8
    container_name: datanode
    restart: always
    volumes:
      - hadoop_datanode:/hadoop/dfs/data
    environment:
      SERVICE_PRECONDITION: "namenode:9870"
    env_file:
      - ./hadoop.env
  resourcemanager:
    image: bde2020/hadoop-resourcemanager:2.0.0-hadoop3.2.1-java8
    container_name: resourcemanager
    restart: always
    environment:
      SERVICE_PRECONDITION: "namenode:9000 namenode:9870 datanode:9864"
    env_file:
      - ./hadoop.env
  nodemanager1:
    image: bde2020/hadoop-nodemanager:2.0.0-hadoop3.2.1-java8
    container_name: nodemanager
    restart: always
    environment:
      SERVICE_PRECONDITION: "namenode:9000 namenode:9870 datanode:9864 resourcemanager:8088"
    env_file:
      - ./hadoop.env
  historyserver:
    image: bde2020/hadoop-historyserver:2.0.0-hadoop3.2.1-java8
    container_name: historyserver
    restart: always
    environment:
      SERVICE_PRECONDITION: "namenode:9000 namenode:9870 datanode:9864 resourcemanager:8088"
    volumes:
      - hadoop_historyserver:/hadoop/yarn/timeline
    env_file:
      - ./hadoop.env
  spark:
    build:
      context: ./spark
    container_name: spark
    environment:
      - DISPLAY=192.168.1.162:0.0
    ports:
      - 4040:4040
  tensorflow:
    build:
      context: ./tensorflow
    container_name: tensorflow
    environment:
      - DISPLAY=192.168.1.162:0.0
    ports:
      - 6002:6002
    privileged: true
    volumes:
        - /var/run/docker.sock:/var/run/docker.sock


volumes:
  hadoop_namenode:
  hadoop_datanode:
  hadoop_historyserver:
